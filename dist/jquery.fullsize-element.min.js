(function($){"use strict";var $window=$(window),defaultOptions={fullWidth:true,fullHeight:true,valign:"center",halign:"center",constrainProportions:true},elementSize,elementRatio,FullSizeElement,createResizer,createVAligner,createHAligner;elementSize=function($element){return{width:$element.width(),height:$element.height()}};elementRatio=function(size){return size.width/size.height};createVAligner=function(valign){var aligner;valign=$.inArray(valign,["top","center","bottom"])?valign:defaultOptions.valign;if(valign==="bottom"){aligner=function(height,viewportSize){return-(height-viewportSize.height)}}else if(valign==="center"){aligner=function(height,viewportSize){return(viewportSize.height-height)/2}}return aligner};createHAligner=function(halign){var aligner;halign=$.inArray(halign,["left","center","right"])?halign:defaultOptions.halign;if(halign==="right"){aligner=function(width,viewportSize){return-(width-viewportSize.width)}}else if(halign==="center"){aligner=function(width,viewportSize){return(viewportSize.width-width)/2}}return aligner};createResizer=function(constrainProportions,fullWidth,fullHeight,originalSize,originalRatio){var resizer;if(constrainProportions===true){if(fullWidth===true&&fullHeight===true){resizer=function(viewportSize,viewportRatio){var properties={};if(this.originalRatio<viewportRatio){properties.width=viewportSize.width;properties.height=Math.round(viewportSize.width/originalRatio)}else{properties.width=Math.round(viewportSize.height*originalRatio);properties.height=viewportSize.height}return properties}}else if(fullWidth===true){resizer=function(viewportSize){return{width:viewportSize.width,height:viewportSize.width/originalRatio}}}else if(fullHeight===true){resizer=function(viewportSize){return{width:viewportSize.height*this.originalRatio,height:viewportSize.height}}}}else{if(fullWidth===true&&fullHeight===true){resizer=function(viewportSize){return{width:viewportSize.width,height:viewportSize.height}}}else if(fullWidth===true){resizer=function(viewportSize){return{width:viewportSize.width,height:originalSize.height}}}else if(fullHeight===true){resizer=function(viewportSize){return{width:originalSize.width,height:viewportSize.height}}}}return resizer};FullSizeElement=function($element,$viewport,options){this.$element=$element;this.$viewport=$viewport;this.originalSize=elementSize(this.$element);this.originalRatio=elementRatio(this.originalSize);this.valigner=createVAligner(options.valign);this.haligner=createHAligner(options.halign);this.resizer=createResizer(options.constrainProportions,options.fullWidth,options.fullHeight,this.originalSize,this.originalRatio)};FullSizeElement.prototype={resize:function(){var viewportSize=elementSize(this.$viewport),viewportRatio=elementRatio(viewportSize),properties;properties=this.resizer(viewportSize,viewportRatio);properties.top=this.valigner(properties.height,viewportSize);properties.left=this.haligner(properties.width,viewportSize);properties.visibility="visible";this.$element.css(properties)}};FullSizeElement.factory=function(){var elements=[],addResizeListener;addResizeListener=function(){var listening=false;return function(){if(listening===false){listening=true;$window.on("resize",function(){$.each(elements,function(index,fullSizeElement){fullSizeElement.resize()})})}}}();function create($element,$viewport,options){var fullSizeElement=new FullSizeElement($element,$viewport,options);fullSizeElement.resize();elements.push(fullSizeElement);addResizeListener()}return function($element,$viewport,options){if($element.get(0).tagName.toLowerCase()==="img"){$element.imagePreloader({finish:function(){create($element,$viewport,options)}})}else{create($element,$viewport,options)}}}();$.fn.fullSizeElement=function(options){options=$.extend({},defaultOptions,options||{});return this.each(function(){var $element=$(this),$viewport=options.$viewport,viewport=$element.data("viewport");if(viewport){$viewport=$element.parent().closest(viewport)}FullSizeElement.factory($(this),$viewport&&$viewport.size()?$viewport:$window,options)})}})(jQuery);